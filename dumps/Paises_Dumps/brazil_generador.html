<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Generador de Dumps - Brasil</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><defs><linearGradient id='text' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' stop-color='%23ff0000'/><stop offset='100%' stop-color='%23cc0000'/></linearGradient></defs><path d='M8 8 L24 8 L24 24 L8 24 Z' transform='rotate(45 16 16)' fill='none' stroke='%23ff0000' stroke-width='1.5'/><text x='12' y='20' text-anchor='middle' fill='url(%23text)' font-family='Arial' font-weight='bold' font-size='12'>C</text><text x='20' y='20' text-anchor='middle' fill='url(%23text)' font-family='Arial' font-weight='bold' font-size='12'>C</text></svg>">

    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; 
            min-height: 100vh; 
            color: white; 
            overflow-x: hidden; 
            position: relative;
            -webkit-tap-highlight-color: transparent; 
            display: flex;
            flex-direction: column;
        }

        /* PANTALLA DE VERIFICACI√ìN ADMIN */
        #adminSecurityOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: #ff0000;
            font-family: 'Courier New', monospace;
        }

        .security-lock {
            font-size: 48px;
            margin-bottom: 20px;
            animation: lockPulse 2s infinite;
            filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.7));
        }

        .security-text {
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            margin-bottom: 10px;
        }

        .security-subtext {
            font-size: 14px;
            color: #ccc;
            text-align: center;
            margin-top: 10px;
        }

        @keyframes lockPulse {
            0%, 100% { 
                opacity: 0.6;
                transform: scale(1);
            }
            50% { 
                opacity: 1;
                transform: scale(1.1);
            }
        }

        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 10px 15px; 
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 0, 0, 0.3);
            height: 60px; 
            position: sticky; 
            top: 0; 
            z-index: 999;
            box-shadow: 0 4px 20px rgba(255, 0, 0, 0.1);
            flex-shrink: 0;
        }

        .header-left { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .brand-icon {
            font-size: 20px; 
            background: linear-gradient(135deg, #ff0000, #cc0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 8px rgba(255, 0, 0, 0.5));
        }

        .brand-text {
            font-size: 18px; 
            font-weight: 800;
            background: linear-gradient(135deg, #ff0000, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        .back-btn { 
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            color: white; 
            cursor: pointer; 
            padding: 6px 10px; 
            font-size: 12px; 
            text-align: center;
            transition: all 0.3s ease;
            width: auto;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            gap: 4px;
            font-weight: 600;
        }

        .back-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .back-btn:hover { 
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.5);
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(255, 0, 0, 0.2);
        }

        .back-btn:hover::before {
            left: 100%;
        }

        .saldo-btn {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.4);
            color: white;
            padding: 6px 8px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .saldo-btn:hover {
            background: rgba(255, 0, 0, 0.3);
            transform: scale(1.05);
        }

        .hamburger {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            width: 40px;
            height: 32px;
            cursor: pointer;
            padding: 4px;
            border: none;
            background: transparent;
            z-index: 1001;
        }

        .hamburger span {
            width: 100%;
            height: 5px;
            background: linear-gradient(135deg, #ff0000, #cc0000);
            border-radius: 3px;
            transition: all 0.3s ease;
            box-shadow: 0 0 4px rgba(255, 0, 0, 0.5);
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        .hamburger:hover span {
            background: linear-gradient(135deg, #cc0000, #990000);
        }

        .menu-dropdown {
            position: absolute;
            top: 100%;
            right: 15px;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 120px;
            display: none;
            flex-direction: column;
            gap: 5px;
            box-shadow: 0 4px 20px rgba(255, 0, 0, 0.1);
            z-index: 1000;
        }

        .menu-dropdown.active {
            display: flex;
        }

        .dumps-btn { 
            background: rgba(255, 0, 0, 0.1);
            border: none;
            color: white; 
            cursor: pointer; 
            padding: 8px 15px; 
            font-size: 14px; 
            text-align: left;
            transition: all 0.3s ease;
            width: 100%;
            border-radius: 6px;
        }

        .dumps-btn:hover { 
            background: rgba(255, 0, 0, 0.3);
            padding-left: 20px;
            box-shadow: 0 2px 10px rgba(255, 0, 0, 0.3);
        }

        .main-content { 
            flex: 1;
            margin-top: 40px; 
            padding: 15px; 
            min-height: 0;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            display: none; /* Oculto hasta verificaci√≥n */
        }

        .title-section {
            text-align: center;
            margin-bottom: 15px;
        }

        .title-box {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 0, 0, 0.3);
            border-radius: 12px;
            padding: 12px 20px;
            margin: 0 auto;
            display: inline-block;
            box-shadow: 0 8px 25px rgba(255, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .title-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: left 0.6s ease;
        }

        .title-box:hover::before {
            left: 100%;
        }

        .page-title { 
            font-size: 24px; 
            text-align: center; 
            margin: 0;
            font-weight: 800;
            background: linear-gradient(135deg, #ff0000, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
            filter: drop-shadow(0 0 4px rgba(255, 0, 0, 0.3));
        }

        .date-text {
            font-size: 16px;
            text-align: center;
            margin: 8px 0 0 0;
            font-weight: 600;
            background: linear-gradient(135deg, #ff0000, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.3px;
            filter: drop-shadow(0 0 2px rgba(255, 0, 0, 0.2));
        }

        .info-section {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: left;
            box-shadow: 0 8px 30px rgba(255, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }

        .info-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.03), transparent);
            transition: left 0.6s ease;
        }

        .info-section:hover::before {
            left: 100%;
        }

        .info-section h3 {
            font-size: 20px;
            font-weight: 800;
            color: #fff;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #ff0000, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            letter-spacing: -0.3px;
            filter: drop-shadow(0 0 4px rgba(255, 0, 0, 0.3));
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .generate-btn {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.4);
            color: white;
            cursor: pointer;
            padding: 15px;
            font-size: 14px;
            font-weight: 700;
            text-align: center;
            transition: all 0.3s ease;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            gap: 8px;
            flex: 1;
        }

        .generate-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .generate-btn:hover { 
            background: rgba(255, 0, 0, 0.3);
            border-color: rgba(255, 0, 0, 0.6);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 0, 0, 0.3);
        }

        .generate-btn:hover::before {
            left: 100%;
        }

        .btn-success {
            background: rgba(0, 200, 83, 0.2);
            border: 1px solid rgba(0, 200, 83, 0.4);
        }

        .btn-success:hover {
            background: rgba(0, 200, 83, 0.3);
        }

        .btn-warning {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid rgba(255, 165, 0, 0.4);
        }

        .btn-warning:hover {
            background: rgba(255, 165, 0, 0.3);
        }

        .progress-bar { 
            width: 100%; 
            background: #333; 
            border-radius: 5px; 
            margin-top: 10px;
            overflow: hidden;
        }
        .progress-fill { 
            height: 20px; 
            background: linear-gradient(135deg, #00c853, #00a86b); 
            width: 0%; 
            transition: width 0.3s;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            color: white;
        }

        .info-note {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
            text-align: center;
            color: #e0e0e0;
            font-size: 12px;
            font-style: italic;
            line-height: 1.4;
            position: relative;
            overflow: hidden;
        }

        .info-note::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            transition: left 0.6s ease;
        }

        .info-note:hover::before {
            left: 100%;
        }

        .info-note strong {
            color: #ff0000;
            font-weight: 600;
            background: linear-gradient(135deg, #ff0000, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 2px rgba(255, 0, 0, 0.4));
        }

        .document-card {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px; 
            padding: 20px; 
            margin-top: 20px;
            display: none;
            flex-direction: column;
            gap: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        }

        .document-card.show {
            display: flex;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .document-field {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .document-field label {
            font-size: 12px;
            color: #ddd;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-shadow: 0 0 1px rgba(255, 0, 0, 0.2);
        }

        .document-field span {
            background: rgba(255, 255, 255, 0.06);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 0, 0, 0.2);
            font-family: monospace;
            font-size: 14px;
            color: white;
            word-break: break-all;
            text-shadow: 0 0 1px rgba(0, 0, 0, 0.5);
        }

        .history-section {
            margin-top: 20px;
            display: none;
        }

        .history-section.show {
            display: block;
        }

        .history-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-info {
            flex: 1;
        }

        .history-actions {
            display: flex;
            gap: 10px;
        }

        .delete-btn {
            background: rgba(255, 0, 0, 0.3);
            border: 1px solid rgba(255, 0, 0, 0.5);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }

        .delete-btn:hover {
            background: rgba(255, 0, 0, 0.5);
        }

        .footer { 
            background: rgba(17, 17, 17, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px; 
            text-align: center; 
            border-top: 1px solid rgba(51, 51, 51, 0.5); 
            font-size: 12px; 
            color: #666; 
            width: 100%;
            flex-shrink: 0;
        }

        .footer-text {
            background: linear-gradient(135deg, #ff0000, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 2px rgba(255, 0, 0, 0.2));
        }

        .notification {
            position: fixed;
            top: 40px; 
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .notification.show {
            display: block;
            animation: fadeInOut 3s ease-in-out;
        }

        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        ::-webkit-scrollbar { width: 6px; } 
        ::-webkit-scrollbar-track { background: rgba(26, 26, 26, 0.8); border-radius: 3px; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #ff0000, #cc0000); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: linear-gradient(135deg, #cc0000, #990000); }
        
        @media (max-width: 480px) {
            .main-content { 
                padding: 10px; 
                margin-top: 35px; 
            }
            
            .page-title { 
                font-size: 20px; 
            }
            
            .header { 
                padding: 8px 12px; 
                height: 55px; 
            }
            
            .brand-text { 
                font-size: 16px; 
            }
            
            .footer { 
                padding: 10px; 
                font-size: 11px; 
            }
            
            .notification {
                top: 35px; 
                padding: 8px 15px;
                font-size: 14px;
            }

            .title-box {
                padding: 10px 16px;
                border-radius: 10px;
            }

            .back-btn {
                padding: 10px 14px;
                font-size: 13px;
            }

            .date-text {
                font-size: 14px;
                margin-top: 6px;
            }

            .info-section {
                padding: 15px;
                margin-top: 15px;
            }

            .info-section h3 {
                font-size: 18px;
            }

            .info-note {
                padding: 8px;
                font-size: 11px;
                margin-top: 8px;
            }

            .generate-btn {
                padding: 12px;
                font-size: 12px;
            }

            .btn-group {
                flex-direction: column;
            }
        }
    </style>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>

    <div id="adminSecurityOverlay">
        <div class="security-lock">üîí</div>
        <div class="security-text">VALIDANDO ACCESO ADMIN</div>
        <div class="security-subtext">Verificando credenciales de administrador...</div>
    </div>

    <div id="notification" class="notification"></div>

    <div class="header">
        <div class="header-left">
            <div class="brand">
                <div class="brand-icon">üí≥</div>
                <div class="brand-text">DUMPS</div>
            </div>
        </div>
        
        <div style="display: flex; align-items: center; gap: 10px;">
            <button class="saldo-btn" id="btnSaldo">
                Saldo: $<span id="saldoUsuario">0.00</span> USDT
            </button>
            <button class="back-btn" onclick="window.location.href='../clon.html'">
                <span>‚Üê</span>
                <span>Volver</span>
            </button>
            <button class="hamburger" id="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div class="menu-dropdown" id="menuDropdown">
            <button class="dumps-btn" onclick="goToCatalogo()">
                CC Cat√°logo
            </button>
        </div>
    </div>

    <div class="main-content">
        <div class="title-section">
            <div class="title-box">
                <h1 class="page-title">GENERADOR DE DUMPS</h1>
            </div>
            <p id="fechaActual" class="date-text"></p>
            <div class="info-section">
                <h3>Dumps de Brasil üáßüá∑</h3>
                
                <div class="btn-group">
                    <button class="generate-btn" onclick="generarDump()">
                        <span>üé≤</span>
                        <span>GENERAR 1 DUMP</span>
                    </button>
                    <button class="generate-btn btn-success" onclick="generarLote(5)">
                        <span>üì¶</span>
                        <span>LOTE DE 5</span>
                    </button>
                </div>

                <div class="btn-group">
                    <button class="generate-btn btn-warning" onclick="toggleHistory()">
                        <span>üìã</span>
                        <span>VER HISTORIAL</span>
                    </button>
                    <button class="generate-btn" onclick="clearAllDumps()" style="background: rgba(255, 0, 0, 0.3);">
                        <span>üóëÔ∏è</span>
                        <span>BORRAR TODO</span>
                    </button>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill">0%</div>
                </div>
                
                <div class="info-note">
                    <strong>NOTA:</strong> Los datos est√°n OCULTOS para usuarios. Solo se revelan despu√©s de la compra.
                    Esta tarjeta tiene aproximadamente entre 500 a 1000 reales
                </div>
            </div>
        </div>

        <div id="resultado" class="document-card">
            <div class="document-field">
                <label>16 D√≠gitos (Tarjeta):</label>
                <span id="numeroTarjeta">**** **** **** ****</span>
            </div>
            <div class="document-field">
                <label>Fecha Expiraci√≥n:</label>
                <span id="fechaExpiracion">**/**</span>
            </div>
            <div class="document-field">
                <label>CVV:</label>
                <span id="cvv">***</span>
            </div>
            <div class="document-field">
                <label>Nombre Completo:</label>
                <span id="nombreCompleto">****** ******</span>
            </div>
            <div class="document-field">
                <label>Banco Emisor:</label>
                <span id="banco">Ita√∫</span>
            </div>
            <div class="document-field">
                <label>Tipo de Tarjeta:</label>
                <span id="tipoTarjeta">Visa/Mastercard</span>
            </div>
            <div class="document-field">
                <label>Pa√≠s:</label>
                <span id="pais">Brasil</span>
            </div>
            <div class="document-field">
                <label>CPF:</label>
                <span id="identidad">***.***.***-**</span>
            </div>
            <div class="document-field">
                <label>Direcci√≥n:</label>
                <span id="direccion">Rua ******</span>
            </div>
            <div class="document-field">
                <label>Fecha de Nacimiento:</label>
                <span id="fechaNacimiento">**/**/****</span>
            </div>
            <div class="document-field">
                <label>Tel√©fono:</label>
                <span id="telefono">+55 (**) 9*******</span>
            </div>
            <div class="document-field">
                <label>Correo Electr√≥nico:</label>
                <span id="correo">******@****.***</span>
            </div>
            <div class="document-field">
                <label>CEP:</label>
                <span id="codigoZip">***** - ***</span>
            </div>
            <div class="document-field">
                <label>Precio:</label>
                <span id="precio">$45 USD</span>
            </div>
        </div>

        <div id="historySection" class="history-section">
            <h3 style="text-align: center; margin-bottom: 15px;">üìã Historial de Dumps Generados</h3>
            <div id="historyList"></div>
        </div>
    </div>

    <div class="footer">
        <span class="footer-text">DUMPS ¬© 2024 | Sistema Completo</span>
    </div>

    <script>
        // Configuraci√≥n de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyD2tvQjJzh7ukTSyxzIQSo7GSpz7L8z11I",
            authDomain: "ccshop-realtime.firebaseapp.com",
            databaseURL: "https://ccshop-realtime-default-rtdb.firebaseio.com",
            projectId: "ccshop-realtime",
            storageBucket: "ccshop-realtime.appspot.com",
            messagingSenderId: "795626673305",
            appId: "1:795626673305:web:094dc265de1d4d1bc7d408"
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const rtdb = firebase.database();
        const auth = firebase.auth();

        // Variables globales
        let usuarioActual = null;
        let saldoActual = 0;
        let historialDumps = [];

        // EMAIL DEL ADMIN PERMITIDO
        const ADMIN_EMAIL = "johndoechmod777@gmail.com";

        // SISTEMA DE SEGURIDAD MEJORADO
        function initializeAdminSecurity() {
            console.log('üîê Iniciando verificaci√≥n de seguridad de administrador...');
            
            // Mostrar pantalla de verificaci√≥n por 3 segundos m√≠nimo
            setTimeout(() => {
                auth.onAuthStateChanged(function(user) {
                    if (user) {
                        console.log('‚úÖ Usuario autenticado:', user.email);
                        
                        // VERIFICACI√ìN CR√çTICA: Solo el admin espec√≠fico puede acceder
                        if (user.email === ADMIN_EMAIL) {
                            console.log('üéâ Acceso concedido - Usuario admin correcto');
                            usuarioActual = user;
                            showAdminContent();
                        } else {
                            console.log('‚ùå Acceso denegado - No es el admin autorizado');
                            showNotification('‚ùå Acceso restringido - Solo administrador');
                            setTimeout(() => {
                                // RUTA CORREGIDA: Sube dos niveles para llegar a la ra√≠z donde est√° index.html
                                window.location.href = '../../index.html'; 
                            }, 2000);
                        }
                    } else {
                        console.log('‚ùå No hay usuario autenticado');
                        showNotification('üîê Debes iniciar sesi√≥n primero');
                        setTimeout(() => {
                            // RUTA CORREGIDA: Sube dos niveles para llegar a la ra√≠z donde est√° index.html
                            window.location.href = '../../index.html';
                        }, 2000);
                    }
                });
            }, 3000); // 3 segundos de verificaci√≥n

            // Timeout de seguridad adicional
            setTimeout(() => {
                const securityOverlay = document.getElementById('adminSecurityOverlay');
                if (securityOverlay.style.display !== 'none') {
                    console.log('‚è∞ Timeout de seguridad - Redirigiendo...');
                    // RUTA CORREGIDA: Sube dos niveles para llegar a la ra√≠z donde est√° index.html
                    window.location.href = '../../index.html';
                }
            }, 10000); // 10 segundos m√°ximo
        }

        function showAdminContent() {
            console.log('üéâ Mostrando contenido de administrador');
            document.getElementById('adminSecurityOverlay').style.display = 'none';
            document.querySelector('.main-content').style.display = 'block';
            
            // Inicializar el resto de la aplicaci√≥n
            cargarSaldoUsuario();
            cargarHistorial();
            
            // Mostrar fecha actual
            const now = new Date();
            const fechaActual = now.toLocaleDateString('es-ES');
            document.getElementById('fechaActual').textContent = fechaActual;
            
            console.log('‚úÖ Panel de admin cargado para:', usuarioActual.email);
        }

        // FUNCIONES B√ÅSICAS
        // Esta funci√≥n ya no es necesaria si el bot√≥n tiene el onclick directo
        /*
        function goBack() { 
            window.location.href = '../clon.html'; 
        }
        */

        // RUTA CORREGIDA: Apunta a '../clon.html' (un nivel arriba)
        function goToCatalogo() {
            window.location.href = '../clon.html'; 
            toggleMenu();
        }

        function toggleMenu() {
            const hamburger = document.getElementById('hamburger');
            const dropdown = document.getElementById('menuDropdown');
            hamburger.classList.toggle('active');
            dropdown.classList.toggle('active');
        }

        // Cerrar men√∫ al click fuera
        document.addEventListener('click', (e) => {
            const hamburger = document.getElementById('hamburger');
            const dropdown = document.getElementById('menuDropdown');
            if (!hamburger.contains(e.target) && !dropdown.contains(e.target)) {
                hamburger.classList.remove('active');
                dropdown.classList.remove('active');
            }
        });

        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 3000);
        }

        function actualizarProgreso(porcentaje, texto = '') {
            const progressFill = document.getElementById('progressFill');
            if (progressFill) {
                progressFill.style.width = porcentaje + '%';
                progressFill.textContent = texto || porcentaje + '%';
            }
        }

        function toggleHistory() {
            const historySection = document.getElementById('historySection');
            historySection.classList.toggle('show');
            if (historySection.classList.contains('show')) {
                cargarHistorial();
            }
        }

        // DATOS PARA GENERACI√ìN ALEATORIA
        const nombresHombres = ['Jo√£o', 'Pedro', 'Lucas', 'Mateus', 'Gabriel', 'Rafael', 'Gustavo', 'Felipe', 'Rodrigo', 'Eduardo'];
        const nombresMujeres = ['Maria', 'Ana', 'Julia', 'Beatriz', 'Laura', 'Sofia', 'Manuela', 'Valentina', 'Isabela', 'Helena'];
        const apellidos = ['Silva', 'Santos', 'Oliveira', 'Souza', 'Rodrigues', 'Ferreira', 'Alves', 'Pereira', 'Lima', 'Gomes'];
        
        const estados = ['S√£o Paulo', 'Rio de Janeiro', 'Minas Gerais', 'Bahia', 'Paran√°', 'Rio Grande do Sul'];
        const cidades = ['S√£o Paulo', 'Rio de Janeiro', 'Belo Horizonte', 'Salvador', 'Curitiba', 'Porto Alegre'];
        const bairros = ['Vila Mariana', 'Copacabana', 'Savassi', 'Barra', 'Batel', 'Moinhos de Vento'];
        
        const bancosBrasil = ['Ita√∫', 'Bradesco', 'Banco do Brasil', 'Santander', 'Caixa Econ√¥mica'];
        
        // BINs para Brasil
        const binsBrasil = {
            visa: ["453211", "400555", "401200", "408862", "453973"],
            mastercard: ["515799", "222300", "541333", "554265", "510000"]
        };

        // FUNCI√ìN PARA GENERAR CPF V√ÅLIDO
        function generarCPF() {
            let cpf = '';
            for (let i = 0; i < 9; i++) {
                cpf += Math.floor(Math.random() * 10);
            }
            // Primer d√≠gito verificador
            let sum = 0;
            for (let i = 0; i < 9; i++) {
                sum += parseInt(cpf[i]) * (10 - i);
            }
            let remainder = sum % 11;
            let digit1 = (remainder < 2) ? 0 : 11 - remainder;
            cpf += digit1;
            // Segundo d√≠gito verificador
            sum = 0;
            for (let i = 0; i < 10; i++) {
                sum += parseInt(cpf[i]) * (11 - i);
            }
            remainder = sum % 11;
            let digit2 = (remainder < 2) ? 0 : 11 - remainder;
            cpf += digit2;
            // Formatear
            return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        }

        // FUNCI√ìN PARA FORMATEAR CPF OCULTO
        function formatearCPFOculto(cpf) {
            if (!cpf) return '***.***.***-**';
            return cpf.substring(0, 3) + '.***.***-**';
        }

        // FUNCI√ìN PARA GENERAR CEP
        function generarCEP() {
            const parte1 = Math.floor(10000 + Math.random() * 90000).toString().padStart(5, '0');
            const parte2 = Math.floor(100 + Math.random() * 900).toString().padStart(3, '0');
            return `${parte1}-${parte2}`;
        }

        // FUNCI√ìN PARA FORMATEAR CEP OCULTO
        function formatearCEPOculto(cep) {
            if (!cep) return '***** - ***';
            const [p1, p2] = cep.split('-');
            return `${p1.substring(0, 2)}*** - ${p2.substring(0, 1)}**`;
        }

        // FUNCI√ìN PARA GENERAR CORREO ELECTR√ìNICO RANDOM
        function generarCorreoRandom(nombreCompleto) {
            const dominios = ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 'icloud.com'];
            const nombreUsuario = nombreCompleto.toLowerCase()
                .replace(/ /g, '.')
                .replace(/√°/g, 'a').replace(/√©/g, 'e').replace(/√≠/g, 'i')
                .replace(/√≥/g, 'o').replace(/√∫/g, 'u')
                .replace(/√±/g, 'n');
            
            const dominio = dominios[Math.floor(Math.random() * dominios.length)];
            const numeroRandom = Math.floor(Math.random() * 100);
            
            return `${nombreUsuario}${numeroRandom}@${dominio}`;
        }

        // FUNCI√ìN PARA FORMATEAR CORREO OCULTO
        function formatearCorreoOculto(correo) {
            if (!correo) return '******@****.***';
            
            const [usuario, dominio] = correo.split('@');
            const [nombreDominio, extension] = dominio.split('.');
            
            const usuarioOculto = usuario.substring(0, 2) + '*'.repeat(Math.max(0, usuario.length - 2));
            const dominioOculto = nombreDominio.substring(0, 2) + '*'.repeat(Math.max(0, nombreDominio.length - 2));
            
            return `${usuarioOculto}@${dominioOculto}.${extension}`;
        }

        // FUNCI√ìN PARA FORMATEAR DATOS OCULTOS
        function formatearOculto(texto, caracteresVisibles = 3) {
            if (!texto) return '****';
            return texto.substring(0, caracteresVisibles) + '****';
        }

        function formatearNombreOculto(nombreCompleto) {
            if (!nombreCompleto) return '****** ******';
            const partes = nombreCompleto.split(' ');
            if (partes.length >= 2) {
                return partes[0] + ' ' + formatearOculto(partes[1]);
            }
            return formatearOculto(nombreCompleto);
        }

        function formatearTelefonoOculto(telefono) {
            if (!telefono) return '+55 (**) 9*******';
            const match = telefono.match(/\+55 \(([\d]{2})\) ([\d]{5})-([\d]{4})/);
            if (match) {
                return `+55 (${match[1]}) 9****-${match[3].substring(0, 2)}**`;
            }
            return '+55 (**) 9*******';
        }

        /// FUNCI√ìN CORREGIDA PARA FORMATEAR N√öMERO DE TARJETA
        function formatearNumeroTarjeta(numeroTarjeta) {
            if (!numeroTarjeta || numeroTarjeta.length !== 16) return ' **** **** **** ****';
            
            // Mostrar solo primeros 6 d√≠gitos y ocultar el resto con ***** *****
            const primeros6 = numeroTarjeta.substring(0, 6);
            
            return primeros6 + ' ***** *****';
        }

        // FUNCI√ìN PARA GENERAR N√öMERO DE TARJETA (CORREGIDA PARA 16 D√çGITOS)
        function generarNumeroTarjetaCompleto(bin) {
            const digitosRestantes = Math.floor(1000000000 + Math.random() * 9000000000).toString().substring(0, 10);
            return bin + digitosRestantes;
        }

        // FUNCI√ìN PARA GENERAR PRECIO RANDOM
        function generarPrecioRandom() {
            const precios = [15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100];
            return precios[Math.floor(Math.random() * precios.length)];
        }

        // FUNCI√ìN PARA GENERAR DUMP COMPLETO
        async function generarDump() {
            try {
                // Verificar que sea el admin antes de generar
                if (!usuarioActual || usuarioActual.email !== ADMIN_EMAIL) {
                    showNotification('‚ùå Error: No tienes permisos de administrador');
                    return;
                }

                actualizarProgreso(25, 'Generando datos...');
                
                // Generar datos personales
                const esHombre = Math.random() > 0.5;
                const nombres = esHombre ? nombresHombres : nombresMujeres;
                const primerNombre = nombres[Math.floor(Math.random() * nombres.length)];
                const primerApellido = apellidos[Math.floor(Math.random() * apellidos.length)];
                const segundoApellido = apellidos[Math.floor(Math.random() * apellidos.length)];
                const nombreCompleto = `${primerNombre} ${primerApellido} ${segundoApellido}`;
                
                // Seleccionar ubicaci√≥n
                const estado = estados[Math.floor(Math.random() * estados.length)];
                const cidade = cidades[Math.floor(Math.random() * cidades.length)];
                const bairro = bairros[Math.floor(Math.random() * bairros.length)];
                
                // Generar datos de identificaci√≥n
                const fechaNacimiento = generarFechaNacimiento();
                const cpf = generarCPF();
                
                // Generar datos de tarjeta
                const tipoTarjeta = Math.random() > 0.5 ? "Visa" : "Mastercard";
                const bins = binsBrasil[tipoTarjeta.toLowerCase()];
                const bin = bins[Math.floor(Math.random() * bins.length)];
                const numeroTarjeta = generarNumeroTarjetaCompleto(bin);
                const fechaExpiracion = generarFechaExpiracion();
                const cvv = Math.floor(100 + Math.random() * 900).toString();
                const banco = bancosBrasil[Math.floor(Math.random() * bancosBrasil.length)];
                
                // Generar tel√©fono, correo y precios
                const codigosArea = ['11','21','31','41','51','61','71','81'];
                const area = codigosArea[Math.floor(Math.random() * codigosArea.length)];
                const numero = '9' + Math.floor(10000000 + Math.random() * 90000000).toString();
                const telefonoCompleto = `+55 (${area}) ${numero.substring(0,5)}-${numero.substring(5)}`;
                const correo = generarCorreoRandom(nombreCompleto);
                const precio = generarPrecioRandom();
                const cep = generarCEP();

                actualizarProgreso(50, 'Creando documento...');
                
                // Formatear n√∫mero de tarjeta para mostrar
                const numeroTarjetaFormateado = formatearNumeroTarjeta(numeroTarjeta);
                
               // Crear objeto dump para Firebase
                const dumpData = {
                    // Datos COMPLETOS (para admin)
                    numero_tarjeta_completo: numeroTarjeta,
                    cvv_completo: cvv,
                    nombre_completo: nombreCompleto,
                    dni_completo: cpf,
                    telefono_completo: telefonoCompleto,
                    correo_completo: correo,
                    fecha_nacimiento_completa: fechaNacimiento,
                    
                    // Datos OCULTOS (para usuarios)
                    numero_tarjeta: numeroTarjetaFormateado,
                    cvv: '***',
                    nombre: formatearNombreOculto(nombreCompleto),
                    dni: formatearCPFOculto(cpf),
                    telefono: formatearTelefonoOculto(telefonoCompleto),
                    correo: formatearCorreoOculto(correo),
                    fecha_nacimiento: '**/**/****',
                                    
                    // Informaci√≥n general
                    banco: banco,
                    tipo_tarjeta: tipoTarjeta,
                    pais: "Brasil",
                    departamento: estado,
                    municipio: cidade,
                    direccion: `Rua ${formatearOculto(bairro)}, ${cidade}`,
                    codigo_zip: formatearCEPOculto(cep),
                    precio: precio,
                    fecha_expiracion: fechaExpiracion,
                                    
                    // Metadatos
                    fecha_creacion: new Date(),
                    vendido: false,
                    creado_por: usuarioActual ? usuarioActual.uid : 'sistema'
                };

                actualizarProgreso(75, 'Guardando en Firebase...');
                
                // Guardar en Firebase
                const docRef = await db.collection("dumps").add(dumpData);
                
                // Agregar al historial local
                historialDumps.push({
                    id: docRef.id,
                    ...dumpData,
                    fecha: new Date().toLocaleString()
                });
                
                actualizarProgreso(100, '¬°Completado!');
                
                // Mostrar resultados en la interfaz
                mostrarResultadoOculto(dumpData);
                
                // Actualizar historial
                cargarHistorial();
                
                showNotification('‚úÖ Dump generado y guardado correctamente');
                
                setTimeout(() => actualizarProgreso(0, ''), 2000);
                
            } catch (error) {
                console.error('Error generando dump:', error);
                showNotification('‚ùå Error: ' + error.message);
                actualizarProgreso(0, 'Error');
            }
        }

        // FUNCI√ìN PARA MOSTRAR DATOS OCULTOS
        function mostrarResultadoOculto(datos) {
            document.getElementById('numeroTarjeta').textContent = datos.numero_tarjeta;
            document.getElementById('fechaExpiracion').textContent = datos.fecha_expiracion;
            document.getElementById('cvv').textContent = datos.cvv;
            document.getElementById('nombreCompleto').textContent = datos.nombre;
            document.getElementById('banco').textContent = datos.banco;
            document.getElementById('tipoTarjeta').textContent = datos.tipo_tarjeta;
            document.getElementById('pais').textContent = datos.pais;
            document.getElementById('identidad').textContent = datos.dni;
            document.getElementById('direccion').textContent = datos.direccion;
            document.getElementById('fechaNacimiento').textContent = datos.fecha_nacimiento;
            document.getElementById('telefono').textContent = datos.telefono;
            document.getElementById('correo').textContent = datos.correo;
            document.getElementById('codigoZip').textContent = datos.codigo_zip;
            document.getElementById('precio').textContent = `$${datos.precio} USD`;
            
            document.getElementById('resultado').classList.add('show');
        }

        // FUNCIONES AUXILIARES
        function generarFechaNacimiento() {
            const a√±o = 1980 + Math.floor(Math.random() * 25);
            const mes = Math.floor(Math.random() * 12) + 1;
            const dia = Math.floor(Math.random() * 28) + 1;
            return `${dia.toString().padStart(2, '0')}/${mes.toString().padStart(2, '0')}/${a√±o}`;
        }

        function generarFechaExpiracion() {
            const mes = Math.floor(Math.random() * 12) + 1;
            const a√±o = new Date().getFullYear() + Math.floor(Math.random() * 3) + 1;
            return `${mes.toString().padStart(2, '0')}/${a√±o.toString().slice(-2)}`;
        }

        // FUNCI√ìN PARA GENERAR LOTE
        async function generarLote(cantidad) {
            try {
                for (let i = 0; i < cantidad; i++) {
                    actualizarProgreso((i / cantidad) * 100, `Generando ${i + 1}/${cantidad}`);
                    await generarDump();
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
                showNotification(`‚úÖ Lote de ${cantidad} dumps generado`);
            } catch (error) {
                showNotification('‚ùå Error en el lote: ' + error.message);
            }
        }

        // FUNCI√ìN PARA CARGAR HISTORIAL
        async function cargarHistorial() {
            try {
                const historyList = document.getElementById('historyList');
                historyList.innerHTML = '<p style="text-align: center; color: #666; padding: 10px;">Cargando historial...</p>';
                
                if (!usuarioActual) {
                    historyList.innerHTML = '<p style="text-align: center; color: #ff4444; padding: 20px;">Error: No hay usuario autenticado</p>';
                    return;
                }

                // Obtener TODOS los documentos primero
                const snapshot = await db.collection("dumps").get();
                
                // Filtrar manualmente por usuario
                const dumpsUsuario = [];
                snapshot.forEach(doc => {
                    const data = doc.data();
                    if (data.creado_por === usuarioActual.uid) {
                        dumpsUsuario.push({
                            id: doc.id,
                            ...data,
                            fecha: data.fecha_creacion ? data.fecha_creacion.toDate().toLocaleString() : 'Fecha no disponible'
                        });
                    }
                });
                
                historyList.innerHTML = '';
                
                if (dumpsUsuario.length === 0) {
                    historyList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No hay dumps en el historial</p>';
                    return;
                }
                
                // Ordenar por fecha m√°s reciente
                dumpsUsuario.sort((a, b) => {
                    const fechaA = a.fecha_creacion ? a.fecha_creacion.toDate() : new Date(0);
                    const fechaB = b.fecha_creacion ? b.fecha_creacion.toDate() : new Date(0);
                    return fechaB - fechaA;
                });
                
                // Mostrar en la interfaz
                dumpsUsuario.forEach(dump => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    historyItem.innerHTML = `
                        <div class="history-info">
                            <strong>${dump.tipo_tarjeta} - ${dump.banco}</strong><br>
                            <small>${dump.numero_tarjeta} | $${dump.precio} USD</small><br>
                            <small>Creado: ${dump.fecha}</small>
                        </div>
                        <div class="history-actions">
                            <button class="delete-btn" onclick="eliminarDump('${dump.id}')">Eliminar</button>
                        </div>
                    `;
                    historyList.appendChild(historyItem);
                });
                
            } catch (error) {
                console.error('Error cargando historial:', error);
                document.getElementById('historyList').innerHTML = 
                    '<p style="text-align: center; color: #ff4444; padding: 20px;">Error cargando historial: ' + error.message + '</p>';
            }
        }

        async function eliminarDump(id) {
            if (confirm('¬øEst√°s seguro de eliminar este dump?')) {
                try {
                    await db.collection("dumps").doc(id).delete();
                    showNotification('‚úÖ Dump eliminado correctamente');
                    cargarHistorial();
                } catch (error) {
                    showNotification('‚ùå Error eliminando dump: ' + error.message);
                }
            }
        }

        async function clearAllDumps() {
            if (confirm('¬øEst√°s seguro de eliminar TODOS los dumps? Esta acci√≥n no se puede deshacer.')) {
                try {
                    const snapshot = await db.collection("dumps").get();
                    
                    const batch = db.batch();
                    let eliminados = 0;
                    
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        if (data.creado_por === usuarioActual.uid) {
                            batch.delete(doc.ref);
                            eliminados++;
                        }
                    });
                    
                    await batch.commit();
                    showNotification(`‚úÖ ${eliminados} dumps eliminados`);
                    cargarHistorial();
                } catch (error) {
                    showNotification('‚ùå Error eliminando dumps: ' + error.message);
                }
            }
        }

        // SISTEMA DE SALDO
        async function cargarSaldoUsuario() {
            if (!usuarioActual) return;
            
            try {
                const userRef = rtdb.ref('users/' + usuarioActual.uid);
                userRef.on('value', (snapshot) => {
                    const userData = snapshot.val();
                    if (userData && userData.saldo !== undefined) {
                        saldoActual = parseFloat(userData.saldo);
                        document.getElementById('saldoUsuario').textContent = saldoActual.toFixed(2);
                    } else {
                        userRef.set({
                            saldo: 100.00,
                            email: usuarioActual.email,
                            fecha_registro: new Date().toISOString()
                        });
                        saldoActual = 100.00;
                        document.getElementById('saldoUsuario').textContent = '100.00';
                    }
                });
            } catch (error) {
                console.error('Error cargando saldo:', error);
            }
        }

        // INICIALIZACI√ìN
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ Generador de dumps cargado');
            
            // Iniciar sistema de seguridad
            initializeAdminSecurity();
        });
    </script>
</body>
</html>
